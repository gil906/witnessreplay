<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="WitnessReplay Law Enforcement Dashboard - Case Review Portal">
    <meta name="theme-color" content="#0f1923">
    <title>Law Enforcement Dashboard - WitnessReplay</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›¡ï¸</text></svg>">
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/admin.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
</head>
<body class="admin-portal">
    <!-- Login Overlay -->
    <div id="login-overlay" class="login-overlay">
        <div class="login-container">
            <div class="login-header">
                <div class="login-icon">ğŸ›¡ï¸</div>
                <h2>Law Enforcement Portal</h2>
                <p class="login-subtitle">Authorized Personnel Only</p>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="admin-password">Password</label>
                    <input 
                        type="password" 
                        id="admin-password" 
                        name="password" 
                        class="login-input" 
                        placeholder="Enter admin password"
                        required
                        autofocus
                    >
                </div>
                <button type="submit" class="btn btn-primary btn-login">
                    ğŸ”“ Login
                </button>
                <div id="login-error" class="login-error" style="display: none;"></div>
            </form>
            <div class="login-footer">
                <a href="/" class="back-link">â† Back to Witness View</a>
            </div>
        </div>
    </div>

    <div class="container admin-container" id="admin-content" style="display: none;">
        <!-- Admin Header -->
        <header class="header admin-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-icon">ğŸ›¡ï¸</div>
                    <div class="logo-text">
                        <h1>Law Enforcement Dashboard</h1>
                        <p class="tagline">View and manage witness reports</p>
                    </div>
                </div>
                
                <div class="admin-user-info">
                    <div class="user-badge">
                        <div class="user-avatar">ğŸ‘®</div>
                        <div class="user-details">
                            <h3 id="admin-user-name">Officer Admin</h3>
                            <p>Administrator</p>
                        </div>
                    </div>
                </div>
                
                <div class="notification-bell" id="notification-bell" title="Recent activity">
                    ğŸ”” <span class="notification-count" id="notification-count" style="display:none">0</span>
                </div>
                
                <div class="admin-actions">
                    <button id="seed-data-btn" class="btn btn-secondary" data-tooltip="Seed demo data">
                        ğŸŒ± Seed Demo Data
                    </button>
                    <button id="refresh-btn" class="btn btn-secondary" data-tooltip="Refresh data">
                        ğŸ”„ Refresh
                    </button>
                    <button id="logout-btn" class="btn btn-secondary" data-tooltip="Logout">
                        ğŸšª Logout
                    </button>
                    <button id="witness-view-btn" class="btn btn-primary" data-tooltip="Switch to witness view">
                        ğŸ™ï¸ Witness View
                    </button>
                </div>
            </div>
        </header>

        <!-- Admin Dashboard -->
        <div class="admin-dashboard">
            <!-- Stats Overview -->
            <section class="stats-overview">
                <div class="stat-card admin-stat">
                    <div class="stat-icon">ğŸ“</div>
                    <div class="stat-details">
                        <div class="stat-value" id="total-cases">0</div>
                        <div class="stat-label">Total Cases</div>
                    </div>
                </div>
                <div class="stat-card admin-stat">
                    <div class="stat-icon">ğŸ‘¥</div>
                    <div class="stat-details">
                        <div class="stat-value" id="total-witnesses">0</div>
                        <div class="stat-label">Witness Reports</div>
                    </div>
                </div>
                <div class="stat-card admin-stat">
                    <div class="stat-icon">ğŸ“Œ</div>
                    <div class="stat-details">
                        <div class="stat-value" id="unassigned-reports">0</div>
                        <div class="stat-label">Unassigned Reports</div>
                    </div>
                </div>
                <div class="stat-card admin-stat">
                    <div class="stat-icon">â±ï¸</div>
                    <div class="stat-details">
                        <div class="stat-value" id="active-today">0</div>
                        <div class="stat-label">Active Today</div>
                    </div>
                </div>
                <div class="stat-card admin-stat">
                    <div class="stat-icon">ğŸ¬</div>
                    <div class="stat-details">
                        <div class="stat-value" id="total-scenes">0</div>
                        <div class="stat-label">Scenes Generated</div>
                    </div>
                </div>
            </section>

            <!-- Compact Quota Widget -->
            <section class="quota-compact" id="quota-dashboard">
                <button class="quota-toggle" id="quota-toggle" type="button">
                    <span class="quota-toggle-icon">â–¸</span> API Usage
                    <span class="quota-timer-badge" id="quota-reset-timer">--:--</span>
                </button>
                <div class="quota-content" id="quota-content" style="display: none;">
                    <table class="quota-table" id="quota-models">
                        <thead>
                            <tr><th>Model</th><th>RPM</th><th>TPM</th><th>RPD</th></tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="4" class="quota-loading">Loading...</td></tr>
                        </tbody>
                    </table>
                    <div class="quota-footer">
                        <span class="quota-updated" id="quota-updated">--</span>
                    </div>
                </div>
            </section>

            <!-- Search & Filter -->
            <section class="admin-controls">
                <div class="search-bar">
                    <input type="text" id="case-search" placeholder="Search by case ID, type, or location..." class="search-input">
                    <button id="search-btn" class="btn btn-primary">ğŸ” Search</button>
                </div>
                
                <div class="filter-controls">
                    <select id="filter-type" class="filter-select">
                        <option value="">All Case Types</option>
                        <option value="accident">Accident</option>
                        <option value="crime">Crime</option>
                        <option value="incident">Incident</option>
                        <option value="other">Other</option>
                    </select>
                    
                    <select id="filter-status" class="filter-select">
                        <option value="">All Statuses</option>
                        <option value="active">Active</option>
                        <option value="complete">Complete</option>
                        <option value="review">Under Review</option>
                    </select>
                    
                    <select id="sort-by" class="filter-select">
                        <option value="date-desc">Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="priority-desc">Highest Priority</option>
                        <option value="priority-asc">Lowest Priority</option>
                        <option value="witnesses-desc">Most Witnesses</option>
                        <option value="scenes-desc">Most Scenes</option>
                    </select>
                    
                    <button id="clear-filters-btn" class="btn btn-secondary">Clear Filters</button>
                </div>
            </section>

            <!-- Advanced Search Toolbar -->
            <div class="search-toolbar">
                <div class="search-input-wrapper">
                    <input type="text" id="search-query" placeholder="Search cases, reports, witnesses..." 
                           oninput="window.adminPortal?.debounceSearch()">
                    <span class="search-icon">ğŸ”</span>
                </div>
                <div class="filter-chips">
                    <select id="adv-filter-status" onchange="window.adminPortal?.applyAdvancedFilters()">
                        <option value="">All Status</option>
                        <option value="open">Open</option>
                        <option value="under_review">Under Review</option>
                        <option value="closed">Closed</option>
                    </select>
                    <select id="adv-filter-type" onchange="window.adminPortal?.applyAdvancedFilters()">
                        <option value="">All Types</option>
                        <option value="accident">Accident</option>
                        <option value="crime">Crime</option>
                        <option value="incident">Incident</option>
                        <option value="other">Other</option>
                    </select>
                    <input type="date" id="filter-date-from" onchange="window.adminPortal?.applyAdvancedFilters()" title="From date">
                    <input type="date" id="filter-date-to" onchange="window.adminPortal?.applyAdvancedFilters()" title="To date">
                    <select id="filter-source" onchange="window.adminPortal?.applyAdvancedFilters()">
                        <option value="">All Sources</option>
                        <option value="chat">ğŸ’¬ Chat</option>
                        <option value="phone">ğŸ“ Phone</option>
                        <option value="voice">ğŸ™ï¸ Voice</option>
                        <option value="email">ğŸ“§ Email</option>
                    </select>
                </div>
            </div>

            <!-- Bulk Operations Toolbar -->
            <div id="bulk-toolbar" class="bulk-toolbar" style="display:none;">
                <span id="selected-count">0 selected</span>
                <button onclick="window.adminPortal?.bulkUpdateStatus('under_review')" class="bulk-btn">ğŸ“‹ Set Under Review</button>
                <button onclick="window.adminPortal?.bulkUpdateStatus('closed')" class="bulk-btn">âœ… Close Cases</button>
                <button onclick="window.adminPortal?.bulkExport()" class="bulk-btn">ğŸ“¥ Export Selected</button>
                <button onclick="window.adminPortal?.clearSelection()" class="bulk-btn danger">âœ– Clear</button>
            </div>

            <!-- View Toggle Tabs -->
            <section class="view-toggle">
                <button class="view-tab active" data-view="cases">ğŸ“ Cases View</button>
                <button class="view-tab" data-view="reports">ğŸ“ Reports View</button>
                <button class="view-tab" data-view="workload">ğŸ‘® Workload</button>
                <button class="view-tab" data-view="dashboard">ğŸ“Š Dashboard</button>
                <button class="view-tab" data-view="map">ğŸ—ºï¸ Map</button>
            </section>

            <!-- Cases List -->
            <section class="cases-section" id="cases-section">
                <div class="section-header">
                    <h2>Cases <span class="section-subtitle" id="cases-count-subtitle"></span></h2>
                    <div class="cases-view-mode">
                        <button class="view-mode-btn active" data-mode="compact" title="Compact View">â–¦</button>
                        <button class="view-mode-btn" data-mode="expanded" title="Expanded View">â–£</button>
                    </div>
                </div>
                
                <div id="cases-list" class="cases-list cases-compact">
                    <div class="loading-state">
                        <div class="spinner"></div>
                        <p>Loading cases...</p>
                    </div>
                </div>
            </section>

            <!-- Reports List (hidden by default) -->
            <section class="cases-section" id="reports-section" style="display: none;">
                <div class="section-header">
                    <h2>Individual Reports <span class="section-subtitle" id="reports-count-subtitle"></span></h2>
                </div>
                
                <div id="reports-list" class="cases-list">
                    <div class="loading-state">
                        <div class="spinner"></div>
                        <p>Loading reports...</p>
                    </div>
                </div>
            </section>

            <!-- Workload View -->
            <section id="workload-section" class="workload-section" style="display: none;">
                <div class="section-header">
                    <h2>ğŸ‘® Investigator Workload</h2>
                    <button id="add-investigator-btn" class="btn btn-primary btn-sm">â• Add Investigator</button>
                </div>

                <!-- Workload Summary Stats -->
                <div class="workload-stats" id="workload-stats">
                    <div class="workload-stat-card">
                        <div class="workload-stat-value" id="stat-total-investigators">0</div>
                        <div class="workload-stat-label">Investigators</div>
                    </div>
                    <div class="workload-stat-card">
                        <div class="workload-stat-value" id="stat-active-cases">0</div>
                        <div class="workload-stat-label">Assigned Cases</div>
                    </div>
                    <div class="workload-stat-card">
                        <div class="workload-stat-value" id="stat-unassigned-cases">0</div>
                        <div class="workload-stat-label">Unassigned</div>
                    </div>
                    <div class="workload-stat-card">
                        <div class="workload-stat-value" id="stat-avg-utilization">0%</div>
                        <div class="workload-stat-label">Avg Utilization</div>
                    </div>
                </div>

                <!-- Investigators Grid -->
                <div id="investigators-grid" class="investigators-grid">
                    <div class="loading-state">
                        <div class="spinner"></div>
                        <p>Loading workload data...</p>
                    </div>
                </div>
            </section>

            <!-- Add/Edit Investigator Modal -->
            <div id="investigator-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="investigator-modal-title">Add Investigator</h2>
                        <button class="modal-close" onclick="window.adminPortal?.closeInvestigatorModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="investigator-form">
                            <input type="hidden" id="inv-edit-id">
                            <div class="form-group">
                                <label for="inv-name">Name *</label>
                                <input type="text" id="inv-name" class="form-input" placeholder="Officer name" required>
                            </div>
                            <div class="form-group">
                                <label for="inv-badge">Badge Number</label>
                                <input type="text" id="inv-badge" class="form-input" placeholder="Badge #">
                            </div>
                            <div class="form-group">
                                <label for="inv-email">Email</label>
                                <input type="email" id="inv-email" class="form-input" placeholder="email@department.gov">
                            </div>
                            <div class="form-group">
                                <label for="inv-department">Department</label>
                                <input type="text" id="inv-department" class="form-input" placeholder="e.g., Homicide, Traffic">
                            </div>
                            <div class="form-group">
                                <label for="inv-max-cases">Max Cases</label>
                                <input type="number" id="inv-max-cases" class="form-input" value="10" min="1" max="50">
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="window.adminPortal?.closeInvestigatorModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Dashboard View -->
            <div id="dashboard-view" class="dashboard-container" style="display:none;">
                <!-- Dashboard Summary Cards -->
                <div class="dashboard-summary-row">
                    <div class="dashboard-summary-card">
                        <div class="summary-icon">ğŸ“</div>
                        <div class="summary-content">
                            <div class="summary-value" id="dash-total-cases">0</div>
                            <div class="summary-label">Total Cases</div>
                        </div>
                    </div>
                    <div class="dashboard-summary-card">
                        <div class="summary-icon">ğŸ“†</div>
                        <div class="summary-content">
                            <div class="summary-value" id="dash-cases-today">0</div>
                            <div class="summary-label">Cases Today</div>
                        </div>
                    </div>
                    <div class="dashboard-summary-card">
                        <div class="summary-icon">ğŸ“…</div>
                        <div class="summary-content">
                            <div class="summary-value" id="dash-cases-week">0</div>
                            <div class="summary-label">This Week</div>
                        </div>
                    </div>
                    <div class="dashboard-summary-card">
                        <div class="summary-icon">â±ï¸</div>
                        <div class="summary-content">
                            <div class="summary-value" id="dash-avg-response">-</div>
                            <div class="summary-label">Avg Response (hrs)</div>
                        </div>
                    </div>
                </div>
                
                <!-- Chart Grid -->
                <div class="dashboard-grid">
                    <div class="chart-card chart-card-wide">
                        <h3>ğŸ“ˆ Crime Trends Over Time</h3>
                        <div class="chart-controls">
                            <button class="chart-period-btn active" data-period="daily">Daily</button>
                            <button class="chart-period-btn" data-period="weekly">Weekly</button>
                            <button class="chart-period-btn" data-period="monthly">Monthly</button>
                        </div>
                        <canvas id="cases-timeline-chart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>ğŸ·ï¸ Cases by Type</h3>
                        <canvas id="incident-types-chart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>ğŸ“‹ Case Status Distribution</h3>
                        <canvas id="case-status-chart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>â±ï¸ Response Time by Type</h3>
                        <canvas id="response-time-chart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>ğŸ“Š Report Sources</h3>
                        <canvas id="source-distribution-chart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>ğŸ• Incidents by Hour</h3>
                        <canvas id="hour-distribution-chart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>ğŸ“… Incidents by Day of Week</h3>
                        <canvas id="day-distribution-chart"></canvas>
                    </div>
                </div>
                
                <!-- Geographic Distribution Section -->
                <div class="geo-distribution-section">
                    <h3>ğŸ—ºï¸ Geographic Distribution</h3>
                    <div class="geo-content">
                        <div class="geo-map-container">
                            <div id="dashboard-map" style="height: 350px; width: 100%; border-radius: 8px;"></div>
                        </div>
                        <div class="geo-top-locations">
                            <h4>Top Locations</h4>
                            <div id="top-locations-list" class="top-locations-list">
                                <p class="empty-state">Loading locations...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Map View -->
            <div id="map-view" class="map-container" style="display:none;">
                <div id="incident-map" style="height: 500px; width: 100%; border-radius: 12px;"></div>
                <div id="map-no-data" class="empty-state" style="display:none;">No location data available for cases</div>
            </div>
        </div>
    </div>

    <!-- Case Detail Modal -->
    <div id="case-detail-modal" class="modal">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h2 id="case-detail-title">Case Details</h2>
                <button class="modal-close" data-modal="case-detail-modal">&times;</button>
            </div>
            
            <div class="modal-body" id="modal-body-content">
                <div class="case-detail-container">
                    <!-- Privacy Notice -->
                    <div class="privacy-notice">
                        <span>ğŸ”’</span>
                        <span>Witness identities are protected. Report numbers are used instead of names.</span>
                    </div>

                    <!-- Priority Section -->
                    <section class="case-priority-section" id="detail-priority-section">
                        <h3>ğŸ“Š Priority Assessment</h3>
                        <div class="priority-overview">
                            <div class="priority-score-display">
                                <span class="priority-score-value" id="detail-priority-score">-</span>
                                <span class="priority-score-label">/100</span>
                            </div>
                            <span class="priority-label-badge" id="detail-priority-label">-</span>
                        </div>
                        <div class="priority-breakdown" id="detail-priority-breakdown">
                            <div class="priority-factor">
                                <div class="priority-factor-value" id="priority-severity">-</div>
                                <div class="priority-factor-label">Severity</div>
                            </div>
                            <div class="priority-factor">
                                <div class="priority-factor-value" id="priority-age">-</div>
                                <div class="priority-factor-label">Age</div>
                            </div>
                            <div class="priority-factor">
                                <div class="priority-factor-value" id="priority-solvability">-</div>
                                <div class="priority-factor-label">Solvability</div>
                            </div>
                            <div class="priority-factor">
                                <div class="priority-factor-value" id="priority-witnesses">-</div>
                                <div class="priority-factor-label">Witnesses</div>
                            </div>
                        </div>
                        <div class="priority-factors-list" id="detail-priority-factors"></div>
                    </section>

                    <!-- Case Info -->
                    <section class="case-info">
                        <h3>Case Information</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Case Number:</label>
                                <span id="detail-case-number">-</span>
                            </div>
                            <div class="info-item">
                                <label>Title:</label>
                                <span id="detail-case-title">-</span>
                            </div>
                            <div class="info-item">
                                <label>Location:</label>
                                <span id="detail-case-location">-</span>
                            </div>
                            <div class="info-item">
                                <label>Status:</label>
                                <span id="detail-case-status">-</span>
                            </div>
                            <div class="info-item">
                                <label>Created:</label>
                                <span id="detail-created">-</span>
                            </div>
                            <div class="info-item">
                                <label>Last Updated:</label>
                                <span id="detail-updated">-</span>
                            </div>
                        </div>
                    </section>

                    <!-- Timeframe -->
                    <section class="case-timeframe" id="detail-timeframe-section" style="display: none;">
                        <h3>Timeframe</h3>
                        <div class="timeframe-display">
                            <div class="timeframe-range">
                                <span class="timeframe-start" id="detail-timeframe-start"></span>
                                <span class="timeframe-arrow">â†’</span>
                                <span class="timeframe-end" id="detail-timeframe-end"></span>
                            </div>
                            <div class="timeframe-description" id="detail-timeframe-desc"></div>
                        </div>
                    </section>

                    <!-- Case Summary -->
                    <section class="case-summary-section" id="detail-summary-section" style="display: none;">
                        <h3>AI-Generated Summary</h3>
                        <div class="case-summary-text" id="detail-case-summary"></div>
                    </section>

                    <!-- Scene Image -->
                    <section class="scene-image-section" id="detail-scene-image-section" style="display: none;">
                        <h3>Scene Reconstruction</h3>
                        <div class="scene-image-container">
                            <img id="detail-scene-image" src="" alt="Scene reconstruction" loading="lazy">
                        </div>
                    </section>

                    <!-- Reports within Case -->
                    <section class="case-reports-section">
                        <h3>Reports (<span id="detail-report-count">0</span>)</h3>
                        <div id="detail-reports-list" class="case-reports-list">
                            <p class="empty-state">No reports in this case</p>
                        </div>
                    </section>

                    <!-- Key Elements -->
                    <section class="case-key-elements" id="detail-key-elements-section" style="display: none;">
                        <h3>Key Elements</h3>
                        <div id="detail-key-elements" class="key-elements-tags"></div>
                    </section>

                    <!-- Case Timeline -->
                    <section class="case-timeline">
                        <h3>ğŸ“… Case Timeline</h3>
                        <div class="timeline-view-toggle">
                            <button id="simple-timeline-btn" class="btn btn-secondary active" data-view="simple">Simple</button>
                            <button id="interactive-timeline-btn" class="btn btn-secondary" data-view="interactive">Interactive</button>
                        </div>
                        <div id="case-timeline" class="timeline-container"></div>
                        <div id="interactive-timeline-container" class="interactive-timeline" style="display:none; min-height: 350px; position: relative;"></div>
                    </section>

                    <!-- Audit Trail -->
                    <section class="audit-trail">
                        <h3>ğŸ“‹ Audit Trail</h3>
                        <div id="audit-trail-list" class="audit-list"></div>
                    </section>

                    <!-- Related Cases -->
                    <section class="related-cases-section" id="related-cases-section">
                        <div class="section-header">
                            <h3>ğŸ”— Related Cases</h3>
                            <button id="find-similar-btn" class="btn btn-secondary btn-sm">ğŸ” Find Similar Cases</button>
                        </div>
                        <div id="related-cases-list" class="related-cases-list">
                            <p class="empty-state">No related cases linked</p>
                        </div>
                        
                        <!-- Similar Cases Suggestions (hidden by default) -->
                        <div id="similar-cases-panel" class="similar-cases-panel" style="display: none;">
                            <h4>ğŸ“Š Suggested Similar Cases</h4>
                            <div id="similar-cases-list" class="similar-cases-list"></div>
                        </div>
                        
                        <!-- Manual Link Form -->
                        <div class="link-case-form" id="link-case-form" style="display: none;">
                            <h4>Link Another Case</h4>
                            <select id="link-case-select" class="filter-select">
                                <option value="">Select a case...</option>
                            </select>
                            <select id="link-type-select" class="filter-select">
                                <option value="related">Related</option>
                                <option value="same_incident">Same Incident</option>
                                <option value="serial">Serial Pattern</option>
                            </select>
                            <input type="text" id="link-notes-input" class="assign-input" placeholder="Notes (optional)">
                            <button id="confirm-link-btn" class="btn btn-primary btn-sm">Link Cases</button>
                            <button id="cancel-link-btn" class="btn btn-secondary btn-sm">Cancel</button>
                        </div>
                        <button id="add-link-btn" class="btn btn-secondary btn-sm">â• Link Case Manually</button>
                    </section>

                    <!-- Pattern Detection -->
                    <section class="pattern-detection-section" id="pattern-detection-section">
                        <div class="section-header">
                            <h3>ğŸ” Pattern Analysis</h3>
                            <button id="analyze-patterns-btn" class="btn btn-secondary btn-sm">ğŸ“Š Analyze Patterns</button>
                        </div>
                        <div id="patterns-container" class="patterns-container" style="display: none;">
                            <div class="pattern-category" id="time-patterns">
                                <h4>â° Time Patterns</h4>
                                <div class="pattern-list" id="time-patterns-list"></div>
                            </div>
                            <div class="pattern-category" id="location-patterns">
                                <h4>ğŸ“ Location Patterns</h4>
                                <div class="pattern-list" id="location-patterns-list"></div>
                            </div>
                            <div class="pattern-category" id="mo-patterns">
                                <h4>ğŸ¯ MO Patterns</h4>
                                <div class="pattern-list" id="mo-patterns-list"></div>
                            </div>
                            <div class="pattern-category" id="semantic-patterns">
                                <h4>ğŸ§  Semantic Matches</h4>
                                <div class="pattern-list" id="semantic-patterns-list"></div>
                            </div>
                        </div>
                        <p id="patterns-empty" class="empty-state">Click "Analyze Patterns" to detect patterns related to this case</p>
                    </section>

                    <!-- Status Workflow -->
                    <div class="status-workflow">
                        <label>Case Status:</label>
                        <select id="case-status-select" class="filter-select">
                            <option value="open">ğŸŸ¢ Open</option>
                            <option value="under_review">ğŸŸ¡ Under Review</option>
                            <option value="closed">ğŸ”´ Closed</option>
                        </select>
                        <button id="update-status-btn" class="btn btn-primary">Update Status</button>
                    </div>

                    <!-- Case Assignment -->
                    <section class="case-assignment-section">
                        <h3>ğŸ‘® Case Assignment</h3>
                        <div class="assignment-controls">
                            <div class="form-group">
                                <label for="investigator-select">Assign to Investigator:</label>
                                <select id="investigator-select" class="filter-select">
                                    <option value="">-- Select Investigator --</option>
                                </select>
                                <button id="assign-btn" class="btn btn-primary btn-sm" onclick="window.adminPortal?.assignCaseToInvestigator()">Assign</button>
                                <button id="unassign-btn" class="btn btn-secondary btn-sm" onclick="window.adminPortal?.unassignCase()" style="display:none;">Unassign</button>
                            </div>
                            <div class="current-assignment" id="current-assignment" style="display:none;">
                                <span class="assignment-badge">ğŸ‘® Assigned to: <strong id="current-assignee-name"></strong></span>
                            </div>
                        </div>
                        <!-- Assignment History -->
                        <div class="assignment-history" id="assignment-history-section" style="display:none;">
                            <h4>ğŸ“‹ Assignment History</h4>
                            <div id="assignment-history-list" class="assignment-history-list"></div>
                        </div>
                    </section>

                    <!-- Actions -->
                    <section class="case-actions">
                        <button id="regenerate-summary-btn" class="btn btn-primary">ğŸ¤– Regenerate Summary</button>
                        <button id="compare-reports-btn" class="btn btn-secondary">ğŸ“Š Compare Reports</button>
                        <button id="upload-evidence-btn" class="btn btn-secondary">ğŸ“· Upload Evidence Photo</button>
                        <button id="print-report-btn" class="btn btn-secondary">ğŸ–¨ï¸ Print Report</button>
                        <button id="export-case-btn" class="btn btn-secondary">ğŸ“¥ Export Case</button>
                        <button id="delete-case-btn" class="btn btn-danger">ğŸ—‘ï¸ Delete Case</button>
                    </section>
                </div>
            </div>
        </div>
    </div>



    <!-- Toast Notifications Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Version Display -->
    <div class="version-badge" id="version-display">
        <span class="version-label">v</span>
        <span class="version-number">0.051</span>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/static/js/timeline.js"></script>
    <script src="/static/js/scene-animation.js"></script>
    <script src="/static/js/admin.js"></script>
</body>
</html>
